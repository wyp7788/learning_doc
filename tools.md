# 需要掌握的GDB命令

- 单步执行进入函数
- 单步执行跳过你不感兴趣的函数(例如库函数)
- 运行到函数末尾
- 打印变量或寄存器的值
- 扫描内存
- 查看调用栈
- 设置断点
- 设置监视点

##  shell 编程

## Shell的基本语法

### 1. 变量

Shell变量由全大写字母加下划线组成，有两种类型的Shell变量：

- 环境变量

  环境变量可以从父进程传给子进程，因此Shell进程的环境变量可以从当前Shell进程传给`fork`出来的子进程。用`printenv`命令可以显示当前Shell进程的环境变量。

- 本地变量

  只存在于当前Shell进程，用`set`命令可以显示当前Shell进程中定义的所有变量（包括本地变量和环境变量）和函数。

环境变量是任何进程都有的概念，而本地变量是Shell特有的概念。在Shell中，环境变量和本地变量的定义和用法相似。在Shell中定义或赋值一个变量：

```
$ VARNAME=value
```

注意等号两边都不能有空格，否则会被Shell解释成命令和命令行参数。

一个变量定义后仅存在于当前Shell进程，它是本地变量，用`export`命令可以把本地变量导出为环境变量，定义和导出环境变量通常可以一步完成：

```
$ export VARNAME=value
```

也可以分两步完成：

```
$ VARNAME=value
$ export VARNAME
```

用`unset`命令可以删除已定义的环境变量或本地变量。

```
$ unset VARNAME
```

如果一个变量叫做`VARNAME`，用`${VARNAME}`可以表示它的值，在不引起歧义的情况下也可以用`$VARNAME`表示它的值。通过以下例子比较这两种表示法的不同：

```
$ echo $SHELL
$ echo $SHELLabc
$ echo $SHELL abc
$ echo ${SHELL}abc
```

注意，在定义变量时不用$，取变量值时要用$。和C语言不同的是，Shell变量不需要明确定义类型，事实上Shell变量的值都是字符串，比如我们定义`VAR=45`，其实`VAR`的值是字符串`45`而非整数。Shell变量不需要先定义后使用，如果对一个没有定义的变量取值，则值为空字符串。

### 2. 文件名代换（Globbing）：* ? []

这些用于匹配的字符称为通配符（Wildcard），具体如下：



**表 31.1. 通配符**

| *          | 匹配0个或多个任意字符              |
| ---------- | ---------------------------------- |
| ?          | 匹配一个任意字符                   |
| [若干字符] | 匹配方括号中任意一个字符的一次出现 |



```
$ ls /dev/ttyS*
$ ls ch0?.doc
$ ls ch0[0-2].doc
$ ls ch[012][0-9].doc
```

注意，Globbing所匹配的文件名是由Shell展开的，也就是说在参数还没传给程序之前已经展开了，比如上述`ls ch0[012].doc`命令，如果当前目录下有`ch00.doc`和`ch02.doc`，则传给`ls`命令的参数实际上是这两个文件名，而不是一个匹配字符串。

### 3. 命令代换：`或 $()

由反引号括起来的也是一条命令，Shell先执行该命令，然后将输出结果立刻代换到当前命令行中。例如定义一个变量存放`date`命令的输出：

```
$ DATE=`date`
$ echo $DATE
```

命令代换也可以用`$()`表示：

```
$ DATE=$(date)
```

### 4. 算术代换：$(())

用于算术计算，`$(())`中的Shell变量取值将转换成整数，例如：

```
$ VAR=45
$ echo $(($VAR+3))
```

`$(())`中只能用+-*/和()运算符，并且只能做整数运算。

### 5. 转义字符\

和C语言类似，\在Shell中被用作转义字符，用于去除紧跟其后的单个字符的特殊意义（回车除外），换句话说，紧跟其后的字符取字面值。例如：

```
$ echo $SHELL
/bin/bash
$ echo \$SHELL
$SHELL
$ echo \\
\
```

比如创建一个文件名为“$ $”的文件可以这样：

```
$ touch \$\ \$
```

还有一个字符虽然不具有特殊含义，但是要用它做文件名也很麻烦，就是-号。如果要创建一个文件名以-号开头的文件，这样是不行的：

```
$ touch -hello
touch: invalid option -- h
Try `touch --help' for more information.
```

即使加上\转义也还是报错：

```
$ touch \-hello
touch: invalid option -- h
Try `touch --help' for more information.
```

因为各种UNIX命令都把-号开头的命令行参数当作命令的选项，而不会当作文件名。如果非要处理以-号开头的文件名，可以有两种办法：

```
$ touch ./-hello
```

或者

```
$ touch -- -hello
```

\还有一种用法，在\后敲回车表示续行，Shell并不会立刻执行命令，而是把光标移到下一行，给出一个续行提示符>，等待用户继续输入，最后把所有的续行接到一起当作一个命令执行。例如：

```
$ ls \
> -l
（ls -l命令的输出）
```

### 6. 单引号

和C语言不一样，Shell脚本中的单引号和双引号一样都是字符串的界定符（双引号下一节介绍），而不是字符的界定符。单引号用于保持引号内所有字符的字面值，即使引号内的\和回车也不例外，但是字符串中不能出现单引号。如果引号没有配对就输入回车，Shell会给出续行提示符，要求用户把引号配上对。例如：

```
$ echo '$SHELL'
$SHELL
$ echo 'ABC\（回车）
> DE'（再按一次回车结束命令）
ABC\
DE
```

### 7. 双引号

双引号用于保持引号内所有字符的字面值（回车也不例外），但以下情况除外：

- $加变量名可以取变量的值
- 反引号仍表示命令替换
- \$表示$的字面值
- \`表示`的字面值
- \"表示"的字面值
- \\表示\的字面值
- 除以上情况之外，在其它字符前面的\无特殊含义，只表示字面值

```
$ echo "$SHELL"
/bin/bash
$ echo "`date`"
Sun Apr 20 11:22:06 CEST 2003
$ echo "I'd say: \"Go for it\""
I'd say: "Go for it"
$ echo "\"（回车）
>"（再按一次回车结束命令）
"

$ echo "\\"
\
```

## Makefile 编写



